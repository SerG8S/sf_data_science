
# Проект 1. Анализ резюме на hh.ru

## Оглавление

* [1. Описание проекта](https://github.com/SerG8S/sf_data_science/edit/main/project_1/readme.md#Описание-проекта)
* [2. Какой кейс решаем?](https://github.com/SerG8S/sf_data_science/edit/main/project_1/readme.md#Какой-кейс-решаем)
* [3. Краткая информация о данных](https://github.com/SerG8S/sf_data_science/edit/main/project_1/readme.md#Краткая-информация-о-данных)
* [4. Этапы работы над проектом](https://github.com/SerG8S/sf_data_science/edit/main/project_1/readme.md#Этапы-работы-над-проектом)
* [5. Результат](https://github.com/SerG8S/sf_data_science/edit/main/project_1/readme.md#Результат)
* [6. Выводы](https://github.com/SerG8S/sf_data_science/edit/main/project_1/readme.md#Выводы)

## Описание проекта

✍ Настало время попробовать свои силы в реальном Data Science-проекте. Вам предстоит решить часть настоящей бизнес-задачи и примерить роль аналитика в компании HeadHunter. Проект станет новым этапом сбора вашего портфолио на GitHub, которым вы сможете похвастаться перед работодателем!

## Какой кейс решаем?

⭐ Компания HeadHunter хочет построить модель, которая бы автоматически определяла примерный уровень заработной платы, подходящей пользователю, исходя из информации, которую он указал о себе. Но, как вы знаете, прежде чем построить модель, данные необходимо преобразовать, исследовать и очистить. В этом и состоит наша с вами задача!

Наш проект будет состоять из четырёх частей:

1. Базовый анализ структуры данных;
2. Преобразование данных;
3. Разведывательный анализ;
4. Очистка данных.

Каждая часть будет состоять из блока практических заданий, которые вам необходимо выполнить в своих jupyter-ноутбуках, и ответить на контрольные вопросы.

Что необходимо сделать для успешного выполнения проекта?

- Внимательно изучить детали задачи.
- Скачать уже знакомый [датасет](https://disk.yandex.ru/d/jiimXti754OpyA) и [ноутбук-шаблон](https://disk.yandex.ru/d/z83Yvtm-w7n82w).
- Обязательно ознакомиться с дополнительным теоретическим материалом, который даётся перед заданием.
- Воспользоваться нашими советами и подсказками при выполнении проекта.
- Ответить на все контрольные вопросы.
- Загрузить ноутбук со своим решением на GitHub, оформив его в соответствии с требованиями.

Требования к оформлению ноутбука-решения

- Решение оформляется только в Jupyter Notebook;
- Решение оформляется в соответствии с [ноутбук-шаблон](https://disk.yandex.ru/d/z83Yvtm-w7n82w);
- Каждое задание выполняется в отдельной ячейке, выделенной под задание (в шаблоне они помечены как ваш код здесь). Не следует создавать множество ячеек для решения задачи — это создаёт неудобства при проверке;
- Код для каждого задания оформляется в одной-двух jupyter-ячейках (не стоит создавать множество ячеек для решения задачи, это усложняет проверку);
- Решение должно использовать только пройденный материал: переменные, основные структуры данных (списки, словари, множества), циклы, функции, библиотеки numpy, pandas, matplotlib, seaborn, plotly. Если вы думаете, что для решения необходимо воспользоваться сторонними библиотеками или инструментами (например Excel), другими языками программирования или неизученными конструкциями, вы ошибаетесь :) Все задания решаются с помощью уже знакомых методов;
- Код должен быть читаемым и понятным: имена переменных и функций отражают их сущность, важно избегать многострочных конструкций и условий;
- Пользуйтесь руководством [PEP 8](https://github.com/SerG8S/sf_data_science/blob/main/The_Zen_of_Python.md);
- Графики оформляются в соответствии с теми правилами, которые мы приводили в модуле по 
[визуализации данных](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#метрика-качества);
- Обязательное требование: графики должны содержать название, отражающее их суть, и подписи осей;
- Выводы к графикам оформляются в формате Markdown под самим графиком в отдельной ячейке (в шаблоне они помечены как ваши выводы здесь). Выводы должны быть представлены в виде небольших связанных предложений на русском языке.

## Краткая информация о данных

Столбцы таблицы (hh_database.csv):

- Пол, возраст;
- ЗП;
- Ищет работу на должность;
- Город, переезд, командировки;
- Занятость;
- График;
- Опыт работы;
- Последнее/нынешнее место работы;
- Последняя/нынешняя должность;
- Образование и ВУЗ;
- Обновление резюме;
- Авто.

## Этапы работы над проектом

1. Выполнил импорт необходимых библиотек для работы:

- Pandas;
- Numpy;
- Plotly;
- Counter.

### 2. Исследование структуры данных: 
✍ Начинаем мы, конечно же, со знакомства с данными и исследования их структуры. Нам важно понять, как устроены признаки в данных и какие типы они имеют, чтобы произвести дальнейшие преобразования.

### 2.1. Задание
Прочитайте данные с помощью библиотеки Pandas. Перед чтением обратите внимание на разделитель внутри файла.

- Чему равна размерность таблицы?

- Ответ: Размерность таблицы равна (44744, 12), кортеж (число строк, число столбцов).

### 2.2. Задание
Выведите несколько первых (последних) строк таблицы, чтобы убедиться в том, что ваши данные не повреждены. Ознакомьтесь с признаками и их структурой. 

- В каком формате представлен порядок слов в признаке «Пол, возраст»?

- Ответ: Порядок слов в признаке «Пол, возраст»: <Мужчина ,  39 лет , родился 27 ноября 1979> представлен в формате <Пол , возраст , дата рождения>.

### 2.3. Задание
Выведите основную информацию о числе непустых значений в столбцах и их типах в таблице. 

- Какой тип данных имеют все столбцы?

- Ответ: Тип данных, который используется во всех столбцах: object.

### 2.4. Задание
Обратите внимание на информацию о числе непустых значений.

- Отобразите все признаки, в которых есть пропуски в данных:

- Ответ:
- Признаки, в которых есть пропуски в данных:
1. Опыт работы - 168;
2. Последнее/нынешнее место работы - 1;
3. Последняя/нынешняя должность - 2.

### 2.5. Задание
Выведите основную статистическую информацию о столбцах.

- Сколько уникальных значений содержится в столбце «Опыт работы»?

- Ответ: Количество уникальных значений в столбце «Опыт работы»: 44413.

- Какая из искомых должностей самая распространённая?

- Ответ: Самая распространенная должноcть: «Системный администратор».

✍ Итак, ещё раз внимательно присмотритесь к столбцам таблицы и информации, которую они содержат: это поможет вам успешно выполнить проект. Ну а мы начинаем настоящую работу с данными!

### 3. Преобразование данных:

✍ Теперь, когда мы познакомились с информацией в таблице, настало время самого сложного этапа — предобработки данных.

Как вы могли уже заметить, наши данные очень «сырые»: признаки представлены в неудобном для анализа и очистки формате.

Например, столбец «Пол/возраст» содержит информацию и о поле, и о возрасте, и о дате рождения. Желаемая заработная плата представлена в виде текста с указанием валюты, в которой она исчисляется, и так далее…

Всё это не позволяет нам визуально оценить зависимости в данных: построить гистограмму распределения зарплаты и возраста, столбчатую диаграмму зарплаты по уровню образования и многое другое. Более того, мы не можем в таком виде заполнить пропущенные значения числовыми константами или найти выбросы. Иными словами, нам необходимо преобразовать данные, что позволит грамотно работать с ними.

⚡ Важно! Старайтесь выполнять обработку с помощью функций-преобразований (lambda-функций), которые принимают аргументом элемент столбца и возвращают его преобразованную версию. Данные функции применяйте к признакам с помощью метода apply().

### 3.1. Задание

Начнём с простого — с признака «Образование и ВУЗ». Его текущий формат — это: <Уровень образования год выпуска ВУЗ специальность...>. 

Например:

- Высшее образование 2016 Московский авиационный институт (Национальный исследовательский университет);
- Неоконченное высшее образование 2000 Балтийская государственная академия рыбопромыслового флота.

Нас будет интересовать только уровень образования.

Создайте с помощью функции-преобразования новый признак «Образование», который должен иметь четыре категории: «высшее», «неоконченное высшее», «среднее специальное» и «среднее».

Выполните преобразование, ответьте на контрольные вопросы и удалите признак «Образование и ВУЗ».

1. Совет: Обратите внимание на структуру текста в столбце «Образование и ВУЗ». Гарантируется, что текущий уровень образования соискателя всегда отражён в первых двух словах и начинается с заглавной буквы. Воспользуйтесь этим.
2. Совет: Проверяйте полученные категории, например с помощью метода unique().

- Сколько соискателей имеет средний уровень образования (школьное образование)?

- Ответ: Средний уровень образования (школьное образование) имеет 559 соискателей.

### 3.2. Задание

Теперь нас интересует столбец «Пол, возраст». Его текущий формат: <Пол , возраст, дата рождения>. Например:

- Мужчина , 39 лет , родился 27 ноября 1979;
- Женщина , 21 год , родилась 13 января 2000.

Как вы понимаете, нам необходимо выделить каждый параметр в отдельный столбец.

Создайте два новых признака «Пол» и «Возраст». При этом важно учесть:

- Признак пола должен иметь одно из уникальных строковых значения: 'М' - мужчина или 'Ж' - женщина;
- Признак возраста должен быть представлен целыми числами.

Выполните преобразование, ответьте на контрольные вопросы и удалите признак «Пол, возраст» из таблицы.

- Сколько процентов женских резюме представлено в наших данных?

- Ответ: Среди соискателей представленно 19.07 % резюме женщин.

- Чему равен средний возраст соискателей?

- Ответ: Средний возраст соискателей составляет 32.2 года.

### 3.3. Задание

Следующим этапом преобразуем признак «Опыт работы». Его текущий формат: <Опыт работы: n лет m месяцев, периоды работы в различных компаниях…>.

Из столбца нам необходимо выделить общий опыт работы соискателя в месяцах, новый признак назовём «Опыт работы (месяц)».

Для начала обсудим условия решения задачи:

- Во-первых, в данном признаке есть пропуски. Условимся, что, если мы встречаем пропуск, оставляем его как есть (функция-преобразование возвращает NaN);
- Во-вторых, в данном признаке есть скрытые пропуски. Для некоторых соискателей в столбце стоит значение Не указано. Их тоже обозначим как NaN (функция-преобразование возвращает NaN);
- Во-третьих, нас не интересует информация, которая описывается после указания опыта работы (периоды работы в различных компаниях).
- В-четвёртых, у нас есть проблема: опыт работы может быть представлен только в годах или только в месяцах. Например, можно встретить следующие варианты:

- Опыт работы 3 года 2 месяца;
- Опыт работы 4 года;
- Опыт работы 11 месяцев;

Учитывайте эту особенность в вашем коде.

В результате преобразования у вас должен получиться столбец, содержащий информацию о том, сколько месяцев проработал соискатель.

Выполните преобразование и удалите столбец «Опыт работы» из таблицы.

- Чему равен медианный опыт работы (в месяцах) в нашей таблице?
- Медианный опыт работы составляет 100 месяцев.

### 3.4. Задание

Хорошо идём! :) Следующий на очереди — признак «Город, переезд, командировки». Информация в нём представлена в следующем виде: <Город, (метро), готовность к переезду (города для переезда), готовность к командировкам>.

В скобках указаны необязательные параметры строки. Например, можно встретить следующие варианты:

- Москва , не готов к переезду , готов к командировкам;
- Москва , м. Беломорская , не готов к переезду, не готов к командировкам;
- Воронеж , готов к переезду (Сочи, Москва, Санкт-Петербург) , готов к командировкам.

Создадим отдельные признаки «Город», «Готовность к переезду», «Готовность к командировкам». При этом важно учесть:

⛏ Признак «Город» может содержать только четыре категории: «Москва», «Санкт-Петербург» и «город-миллионник» (их список ниже), остальные обозначьте как «другие».

million_cities = ['Новосибирск', 'Екатеринбург', 'Нижний Новгород', 'Казань', 'Челябинск', 'Омск', 'Самара', 'Ростов-на-Дону', 'Уфа', 'Красноярск', 'Пермь', 'Воронеж', 'Волгоград']

Информация о метро, рядом с которым проживает соискатель, нас не интересует.

⛏ Признак «Готовность к переезду» должен иметь два возможных варианта: True или False. Обратите внимание, что возможны несколько вариантов описания готовности к переезду в признаке «Город, переезд, командировки». Например:

- … , готов к переезду , …
- … , не готова к переезду , …
- … , готова к переезду (Москва, Санкт-Петербург, Ростов-на-Дону)
- … , хочу переехать (США) , …

Нас интересует только сам факт возможности/желания переезда.

⛏ Признак «Готовность к командировкам» должен иметь два возможных варианта: True или False. Обратите внимание, что возможны несколько вариантов описания готовности к командировкам в признаке «Город, переезд, командировки». Например:

- … , готов к командировкам , …
- … , готова к редким командировкам , …
- … , не готов к командировкам , …

Нас интересует только сам факт готовности к командировке.

Ещё один важный момент: при выгрузке данных у некоторых соискателей «потерялась» информация о готовности к командировкам. Давайте по умолчанию будем считать, что такие соискатели не готовы к командировкам.

Выполните преобразования и удалите столбец «Город, переезд, командировки» из таблицы.

- Совет: Обратите внимание на то, что структура текста может меняться в зависимости от указания ближайшего метро. Учтите это, если будете использовать порядок слов в своей программе.

- Сколько процентов соискателей живут в Санкт-Петербурге?
- Среди соискателей в Санкт-Петербурге живут 11 %.
- Сколько процентов соискателей готовы одновременно и к переездам, и к командировкам?
- Доля соискателей готовых и к переезду, и к командировкам составляет 32 %.

### 3.5. Задание

Рассмотрим поближе признаки «Занятость» и «График».

Сейчас признаки представляют собой набор категорий желаемой занятости (полная занятость, частичная занятость, проектная работа, волонтёрство, стажировка) и желаемого графика работы (полный день, сменный график, гибкий график, удалённая работа, вахтовый метод).

На сайте hh.ru соискатель может указывать различные комбинации данных категорий, например:

- полная занятость, частичная занятость;
- частичная занятость, проектная работа, волонтёрство;
- полный день, удалённая работа;
- вахтовый метод, гибкий график, удалённая работа, полная занятость.

Такой вариант признаков имеет множество различных комбинаций, а значит, множество уникальных значений, что мешает анализу. Нужно это исправить!

Давайте создадим признаки-«мигалки» для каждой категории: если категория присутствует в списке желаемых соискателем, то в столбце на месте строки рассматриваемого соискателя ставится True, иначе — False.

Такой метод преобразования категориальных признаков называется One Hot Encoding, его схема представлена на рисунке ниже:
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_1/dst-3.0_16_3_1.png)

Выполните данное преобразование для признаков «Занятость» и «График», ответьте на контрольные вопросы, после чего удалите их из таблицы.

- Сколько людей ищут проектную работу и волонтёрство?
- Среди соискателей проектную работу и волонтёрство ищут 436 человек.

### 3.6. Задание

Наконец, мы добрались до самого главного — признака заработной платы «ЗП». 

В чём наша проблема? — В том, что помимо желаемой заработной платы соискатель указывает валюту, в которой он хотел бы её получать, например:

- 30 000 руб.;
- 50 000 грн.;
- 550 USD.

Нам бы хотелось видеть заработную плату в единой валюте, например в рублях. Возникает вопрос: а где взять курс валют по отношению к рублю?

На самом деле язык Python имеет в арсенале огромное количество возможностей получения данной информации: от обращения к API Центробанка, до использования специальных библиотек, например pycbrf. Однако в рамках нашего проекта эти темы мы рассматривать не будем.

Поэтому просто обратимся к профильным интернет-ресурсам для получения данных о курсе в виде текстовых файлов. Например, MDF.RU: данный ресурс позволяет удобно экспортировать данные о курсах различных валют и акций за указанные периоды в виде csv. Мы уже сделали выгрузку курсов валют, которые встречаются в наших данных за период с 29.12.2017 по 05.12.2019: скачать её вы можете [здесь]((https://disk.yandex.ru/d/zQQTlw22FFuakQ).

Cтолбцы таблицы (ExchangeRates.csv):

- currency — наименование валюты в ISO-кодировке;
- per - период;
- date — дата;
- time - время;
- close — цена закрытия (последний зафиксированный курс валюты на указанный день);
- vol - количество;
- proportion — пропорция.

Создайте новый DataFrame из скачанного файла. В полученной таблице нас будут интересовать столбцы:

- currency — наименование валюты в ISO-кодировке;
- date — дата;
- proportion — пропорция;
- close — цена закрытия (последний зафиксированный курс валюты на указанный день).

Перед вами таблица соответствия наименований иностранных валют в наших данных и их общепринятых сокращений, которые представлены в файле с курсами валют.

Пропорция — это число, отражающее, скольким единицам валюты соответствует курс в таблице с курсами. Например для казахстанского тенге курс на 20.08.2019 составляет 17.197 руб. за 100 тенге, тогда итоговый курс равен: 17.197 / 100 = 0.17197 руб. за 1 тенге.

Воспользуйтесь этой информацией в ваших преобразованиях.

![Иллюстрация к проекту]()

Осталось понять, откуда брать дату, по которой определяется курс. А вот же она — в признаке «Обновление резюме» содержится дата и время, когда соискатель выложил текущий вариант своего резюме. Нас интересует только дата, по ней мы и будем сопоставлять курсы валют.

Теперь у нас есть вся необходимая информация для того, чтобы создать признак «ЗП(руб).» — заработная плата в рублях.

Итак, давайте обсудим возможный алгоритм преобразования.

1. Перевести признак «Обновление резюме» из таблицы с резюме в формат datetime и достать из него дату. В тот же формат привести признак date из таблицы с валютами. Обратите внимание на формат даты в исходных столбцах (день-месяц-год), учтите этот факт при преобразовании.

2. Выделить из столбца «ЗП» сумму желаемой заработной платы и наименование валюты, в которой она исчисляется. Наименование валюты перевести в стандарт ISO согласно таблице выше.

3. Присоединить к таблице с резюме таблицу с курсами по столбцам с датой и названием валюты (подумайте, какой тип объединения надо выбрать, чтобы в таблице с резюме сохранились данные о заработной плате, изначально представленной в рублях). Значение close для рубля заполнить единицей 1 (курс рубля самого к себе).

4. Умножить сумму желаемой заработной платы на присоединённый курс валюты (close) и разделить на пропорцию. Обратите внимание на пропуски после объединения в этих столбцах. Результат занести в новый столбец «ЗП (руб)».
