# Проект Визуализация. Практика визуализации данных

## Оглавление

* [1. Описание проекта](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#Описание-проекта)
* [2. Какой кейс решаем?](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#Какой-кейс-решаем)
* [3. Краткая информация о данных](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#Краткая-информация-о-данных)
* [4. Этапы работы над проектом](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#Этапы-работы-над-проектом)
* [5. Результат](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#Результат)
* [6. Выводы](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/readme.md#Выводы)

## Описание проекта

⭐ Настало время попробовать свои силы в настоящей Data Science задаче с Kaggle.

**Бизнес:** Банк хочет разработать кампанию лояльности по удержанию клиентов, но для этого ему необходимо, чтобы вы выяснили основные причины оттока клиентов.

**Задача:** Нужно установить, чем ушедшие клиенты отличаются от лояльных и как между собой связаны различные признаки, определяющие клиентов.

Вам представлены данные об оттоке клиентов некоторого банка. Для начала работы с базой данных необходимо загрузить необходимые библиотеки по обработке данных и последующей визуализации.

## Какой кейс решаем?

Вам предстоит подготовить мини-отчёт о проделанной работе в виде файла .ipynb. 

Отчёт должен содержать ответы на приведённые ниже вопросы в виде графиков и подробных выводов, которые вы можете сделать, исходя из него.

**Условия соревнования:**

В файле должно содержаться 10 графиков — 10 ответов к заданиям.

**Метрика качества**

Каждый график и преобразования к нему выполняются в отдельной ячейке.

Под графиком вы должны предоставить свой ответ на вопрос по нему и, если это требуется, выводы, которые вы можете сделать, исходя из графика.

**Что практикуем**

- Исскуство визуализации, можно использовать любую из изученных библиотек (Pandas, Matplotlib, Seaborn, Plotly).
- Перед выполнением задания обязательно подумайте, какие признаки в данных являются числовыми, а какие — категориальными.
- При выполнении заданий обязательно придерживайтесь критериев правильной визуализации.

### Краткая информация о данных

Столбцы таблицы:

- RowNumber — номер строки таблицы (это лишняя информация, поэтому можете сразу от неё избавиться)
- CustomerId — идентификатор клиента
- Surname — фамилия клиента
- CreditScore — кредитный рейтинг клиента (чем он выше, тем больше клиент брал кредитов и возвращал их)
- Geography — страна клиента (банк международный)
- Gender — пол клиента
- Age — возраст клиента
- Tenure — сколько лет клиент пользуется услугами банка
- Balance — баланс на счетах клиента в банке
- NumOfProducts — количество услуг банка, которые приобрёл клиент
- HasCrCard — есть ли у клиента кредитная карта (1 — да, 0 — нет)
- IsActiveMember — есть ли у клиента статус активного клиента банка (1 — да, 0 — нет)
- EstimatedSalary — предполагаемая заработная плата клиента
- Exited — статус лояльности (1 — ушедший клиент, 0 — лояльный клиент)

### Этапы работы над проектом

1. Выполнил импорт необходимых библиотек для работы:
   1. Pandas;
   2. Plotly.

2. Загрузил дата фрейм:
- ['churn.csv'](https://disk.yandex.ru/d/QgDTR9dicf5zRQ)

3. Выполнил предобработку данных, удалил незадействованные столбцы:
    1. RowNumber — номер строки таблицы;
    2. Surname — фамилия клиента.

4. Узучив представленный дата фрейм можно сказать по описанию признаков, что они относятся к категориальному типу данных. Под категориальными признаками обычно подразумевают столбцы в таблице, которые обозначают принадлежность объекта к какому-то классу/категории. Чаще всего представлены в виде текстового описания и кодируются в Pandas типом данных object: Geography, Gender. Однако это не всегда так. 
Например, загруженные нами ранее признаки: NumOfProducts, HasCrCard, IsActiveMember, Exited кодируется числом (int64), но на самом деле является категориальным, поскольку диапазон их значений ограничен и каждому числу мы можем поставить соответствующее значение. Поэтому признаки могут быть разделены:
- Номинальные (Geography, Gender(c английского на русский));
- Порядковыми (NumOfProducts), а также они являются бинарными(HasCrCard, IsActiveMember, Exited), поэтому их можно преобразовать в текстовую информацию (object).

- Столбцы данных (всего 12 столбцов):

- CustomerId - int64  
- CreditScore - int64  
- Geography - object 
- Gender - object 
- Age - int64  
- Tenure - int64  
- Balance - float64
- NumOfProducts - int64  
- HasCrCard - object 
- IsActiveMember - object 
- EstimatedSalary - float64
- Exited - object 

5. Выполнил предобработку данных:

   1. Разделение клиентов по статусу лояльности (ratio_df).
   2. Отфильтрованные клиенты из-за баланса в соответствии с условием более 2.5 тысячь $ (balance).
   3. Создаем признак ушедших клиентов (gone) и фильтруем по полу (gender).
   4. Делаем сводную таблицу зависимости оттока клиентов от числа приобретённых у банка услуг (bar_data).
   6. Делаем сводную таблицу зависимости наличия статуса активного клиента на отток клиентов (activ).
   7. Делаем сводную таблицу предполагаемой средней заработной платы клиента от его кредитного рейтинга и разделения клиентов (credit).
   8. Преобразуем признак (Exited) в числовой и сделаем сводную таблицу стран в которых есть ушедшие клиенты (countryes (Задание 9.9)).
   9. Создаем функция для преобразования числового признака в категориальный (get_credit_score_cat (Задание 9.10)).

6. Изучил доступные средства визуализации в среде разработки Jupyter Notebook и согласно правилам визуализации выполнил задание по построению графиков на основе дата фрейма:
   1. Первое и самое главное правило — график должен быть информативным и понятным. То есть любой человек, взглянув на ваш график, должен понять, что на нём изображено. Для этого всегда подписывайте оси графика или сам график, делайте интервалы между отметками на осях, не используйте слишком много графиков на одной координатной плоскости.
   2. Одна плоскость — один вид графика. Не стоит смешивать типы визуализации, это делает результат нечитабельным.
   3. Принцип минимализма: чем проще график, тем лучше — не нужно добавлять сглаживающие кривые, многочисленные подписи, лишние отметки на осях, яркие, отвлекающие внимание цвета, если это не помогает вам донести идею.
   4. Если тип значений всего один, легенда не нужна.
   5. Не используйте сложный дизайн там, где это не требуется. Прежде чем строить для презентации 3D-график, подумайте, можно ли обойтись без него.
   6. Если у вас несколько диаграмм, используйте единую цветовую гамму.
   7. Время всегда указывается по горизонтальной оси слева направо. Размещайте отметки времени так, чтобы они не сливались друг с другом (например, под углом 45 градусов).
   8. При построении графиков необходимо отталкиваться от их предназначения: например, не надо строить линейный график на категориальных данных — он не предназначен для этого.

Наконец, в завершение темы визуализации предлагаем вам ознакомиться со схемой, на которую вы можете ориентироваться при выборе типа визуализации для своих реальных задач:
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/diagrams.png)

7. Согласно списку вопросов от банка, предоставил ответ в ввиде графиков и письменных пояснений к ним, которые представлены ниже и выводы к ним:
- 1. Каково соотношение ушедших и лояльных клиентов? Покажите это на графике и дайте комментарий по соотношению.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/ratio_.png)
- Выводы:
Количество лояльных клиентов практически в 4 раза больше, чем ушедших. Позитивный показатель, который говорит об отсутсвии массового оттока клиентов, не более 20%.
- 2. Постройте график, показывающий распределение баланса пользователей, у которых на счету больше 2 500 долларов. Опишите распределение и сделайте выводы.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/balance.png)
- Выводы:
Основная часть пользователей сосредоточена в интервале от 50 до 200 тысяч, а наибольшее число клиентов сосредоточено в интервале от 100 до 140 тысяч. Самый высокий прямоугольник расположен в отметке баланса равной 120 тысячам - медианное значение. Далее при увеличении баланса количество пользователей только падает, что говорит нам о том, что в банке обслуживается преимущественно клиенты среднего класса, ввиду наличия одного вклада более 250 тысяч и незначительного количества клиентов с балансом более 200 тысяч, но менее 250 тысяч. Соответственно при разработке программы лояльности, необходимо учитывать чувствительность клиентов к ценовым предложениям по обслуживанию счета и программе лояльности, в основном сосредоточенной в среднем ценовом сегменте. По графику можно отметить, что распределение близко к нормальному.
- 3. Посмотрите на распределение баланса клиента в разрезе признака оттока. Как различаются суммы на накопительном счёте ушедших и лояльных клиентов? Подумайте и напишите, с чем это может быть связано, что может не устраивать ушедших клиентов в банке.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/balance_distributiont.png)
- Выводы:
На коробчатой диаграмме видно смещение, это вызвано большим количеством лояльных клиентов с нулевым балансом, те кто открыл счет, но не пополнил его 3117 человек, что видно на гистограмме. Подобное смещение к нулю на коробчатой диаграмме видно у ушедших клиентов, так как общее количество пользователей с нулевым балансом 3618 человек, ушедших 501 человек, что составляет 14 % от общего числа клиентов с нулевым балансом. Учитывая общее количество пользователей с нулевым балансом, можно сказать, что часть клиентов пользовалась услугами банка как дополнительными, при этом имея основной счет в другом банке на более выгодных условиях или используя преимущественно наличные деньги.
На гистограмме исходя из полученного распределения накоплений лояльных и ушедших клиентов видно, что распределение в обоих случаях нормальное. Это говорит о том, что накопления ушедших и лояльных клиентов распределены по балансу на счете примерно одинаково. Видно, так же что ушедших клиентов гораздо меньше, чем лояльных, суммарное количество лояльных пользователей превышает количество ушедших в 2.5 раза, позитивная динамика. Также большое количество пользователей на сумме баланса которых от 49 тысяч USD до 180 тысяч USD, 631 человек с медианным балансом в 120 тысяч USD, ушедших 244 человека. На коробчатой диаграмме видно смешение медианного значения суммы баланса клиентов указанного в Задании 9.2 со 120 тысяч USD до 92 тысяч USD у лояльных, и 109 тысяч USD у ушедших из-за клиентов с нулевым балансом. Сделать выводы о том, что может не устраивать ушедших из банка клиентов по данному распределению не получится. Необходимы дальнейшие исследования.
- 4. Посмотрите на распределение возраста в разрезе признака оттока. В какой группе больше потенциальных выбросов? На какую возрастную категорию клиентов стоит обратить внимание банку?
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/age_distributiont.png)
- Вывод:
Большое количество потенциальных выбросов находится в лояльной группе, что видно на коробчатой диаграмме, причем это клиенты в возрасте от 57 до 92 лет. Их количество говорит нам о незначительной части клиентов от общего числа. Стоит обратить внимание на группу в возрасте от 38 лет до 51 года на коробчатой диаграмме, так как часть клиентов, сосредоточенная в данном возрасте, находится в категории ушедших клиентов, выбросов незначительное количество. Сравнивая с лояльными клиентами, получаем ящик с усами от 31 года до 41 года, где заканчивается ящик с лояльными клиентами и начинается ящик с ушедшими 38 лет, что говорит об определенном возрастном сдвиге в использовании услуг банка. Разработка программы лояльности должна быть рассчитана на привлечение возрастной группы от 38 лет до 51 года, которые старше на 10 лет категории лояльных клиентов, что подтверждается медианными значениями 36 лет у лояльной категории, и 45 лет у ушедшей категории.
На гистограмме исходя из полученного распределения возраста лояльных и ушедших клиентов видно, что распределение в обоих случаях нормальное, со значительным количеством клиентов 2001 человек в категории лояльных от 35 лет до 39 лет. После начинается существенное падение количества лояльных клиентов из-за возраста, более чем в 2 раза. Но у количества ушедших клиентов нету такого же падения клиентов, связанных с возрастом и распределение более близкое к нормальному.
- 5. Постройте график, который показывает взаимосвязь кредитного рейтинга клиента и его предполагаемой зарплаты. Добавьте расцветку по признаку оттока клиентов. Какова взаимосвязь между признаками? Если не видите явной взаимосвязи, укажите это.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/salary.png)
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/salary_means.png)
- Выводы:
Чем выше кредитный рейтинг, тем "облако" точек плотнее в концентрации, но к увеличению за 760 кредитного рейтинга заметное снижение концентрации. На предполагаемою заработную плату оказал влияние признак оттока клиентов, так как можно увидеть пробелы в "облаке" точек, но при этом заметна равномерная концентрация от самой низкой до самой высокой заработной платы клиента. В целом наблюдается равномерное распределение точек по секторам, что говорит о заинтерисованности в услугах банка людей как с высокой, так и с низкой заработной платой, увеличение влияния параметра кредитного рейтинга начинается после 500 и завершается до 800, а признак лояльности клиента увеличил пробелы в облаке клиентов.
- 6. Кто чаще уходит, мужчины или женщины? Постройте график, который иллюстрирует это.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/sex_.png)
- Выводы:
Разница небольшая, но женщины уходят чаще, чем мужчины.
- 7. Как отток клиентов зависит от числа приобретённых у банка услуг? Для ответа на этот вопрос постройте многоуровневую столбчатую диаграмму.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/bank_service.png)
- Выводы:
Из диаграммы видно, что при наличии 3-х и более услуг у клиента, статус нелояльности к банку увеличивается и превалирует над лояльными клиентами. В категории клиентов, у которых 2-е услуги лояльных больше на 13,4 %, чем в категории клиентов, у которых одна услуга, при этом существенное падение на 98,92 % в категории 3-х услуг, и на 100 % в категории 4-х услуг соответственно. Что говорит о низкой привлекательности банка как экосистемы продуктов, ввиду популярности использования 1-ой или 2-мя услугами из продуктовой линейки банка. Тем самым получается, что самая привлекательная категория клиентов у банка, те кто пользуется двумя услугами, так как самый высокий процент лояльности в аудитории. Необходима программа по увеличению лояльности среди клиентов с одной услугой, для удержания клиентов в банке. И проработка дополнительных услуг, которые не являются привлекательными для аудитории.
- 8. Как влияет наличие статуса активного клиента на отток клиентов? Постройте диаграмму, иллюстрирующую это. Что бы вы предложили банку, чтобы уменьшить отток клиентов среди неактивных?
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/statys.png)
- Выводы:
Активных клиентов на 5,86 % больше, чем не активных, получается что деление просходит примерно пополам. При этом активных, но не лояльных клиентов меньше на 43,54 %, чем в категории не активных клиентов, что говорит нам о 83,35 % лояльных и активных клиентах, остаток клиентов не является лояльным к банку. Неактивных, но лояльных клиентов в банке 63,3 %, остальные не являются активными и лояльными. В группе клиентов, которая не является активной, но при этом лояльна необходимо выявить спект услуг, неиспользуемый клиентом или успользуемый в другом учереждении для привлечения.
- 9. В какой стране доля ушедших клиентов больше? Постройте тепловую картограмму, которая покажет это соотношение на карте мира. Предположите, с чем это может быть связано.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/geo.png)
- Выводы:
Из полученного распределения видно, что самая большая доля ушедших клиентов из Германии, примерно половина всех ушедших, вполне возможно отток клиентов связан с изменением условий обслуживания на территории страны.
- 10. Переведите числовой признак CreditScore в категориальный. Для этого воспользуйтесь функцией get_credit_score_cat(), которая приведена ниже. Примените её к столбцу CreditScore и создайте новый признак CreditScoreCat — категории кредитного рейтинга.
![Иллюстрация к проекту](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/score.png)
- Выводы:
Чаще всего — это клиенты с низким рейтингом, которые только начали пользоваться услугами, но по каким-то причинам не понравилось или доверие которых банк не заполучил. По тепловой карте видно, что чем выше категория клиентов, тем меньше потерь среди клиентов, но при этом высокое количество в категории "Превосходно", в первый год использования и после 9 лет. Так же можно обратить внимание на категорию "Превосходно" в области использования услуг от 2 до 4 лет, потом от 7 до 8 лет, преобладает холодный оттенок, что говорит о низком оттоке клиентов. В последующем происходит увеличение оттока клиентов согласно признаку рейтинга, что требует разработки программы лояльности для клиентов с длительным сроком обслуживания.

6. Написал программу для обработки данных и построения графиков:
[project_visualisation.ipynb](https://github.com/SerG8S/sf_data_science/blob/main/project_visualisation/project_visualisation.ipynb) - проект ноутбука (.ipynb) с графиками.

### Результат

Написана программа по визуализации базы данных об оттоке клиентов банка и получено представление о собранных и обработанных данных.

### Выводы

В процессе написания программы приобретены навыки работы с необходимыми средствами обработки и визуализации для Data Science.
